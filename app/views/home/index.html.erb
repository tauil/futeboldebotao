<h1>Futebol de Botão - Rio de Janeiro</h1>

<p>Peladinha de toda quinta no <a target="_new" href="http://www.botaofc.com.br/loja/">Botão FC</a> no <a target="_new" href="https://www.google.com.br/maps/place/Shopping+Tijuca+-+Av.+Maracan%C3%A3,+987+-+Tijuca,+Rio+de+Janeiro+-+RJ/@-22.9219385,-43.2353733,17z/data=!3m1!5s0x997e6bb2d3ec9f:0xb22ccd0fa557f160!4m7!1m4!3m3!1s0x997e6bb065c221:0xd18c16c53667dc84!2sShopping+Tijuca!3b1!3m1!1s0x997e6bb33b90db:0xdf835aeab427afd6?hl=en">Shopping Tijuca</a></p>

<%= flash_messages %>

<% if show? %>
  <section class="ui segment">
    <%= render 'matches/form' %>
    <div class="ui horizontal divider">Ou</div>
    <p><%= link_to 'Atualizar ranking', update_ranking_path, class: 'ui primary button', disable_with: 'Atualizando...' %></p>
  </section>
<% else %>
  <div id="results-table-container">
    <%= render 'home/ranking_table', rankings: @rankings_2016 %>
    <%= render 'home/ranking_table', rankings: @rankings_2015 %>
  </div>

  <h2 class="ui header">Últimas partidas</h2>
  <% @matches_by_occurrence.each do |match_occurred_at, matches| %>
    <h3 class="ui header"><%= match_occurred_at.to_date %></h3>

    <table class="ui celled table unstackable">
      <tbody>
        <% @players_options.each do |player_name, id| %>
          <% count = Match.by_player_and_occurrence(id, match_occurred_at).count %>
          <% if count > 0 %>
            <tr>
              <td colspan="4"><%= player_name %></td>
              <td><%= count %> partidas jogadas</td>
              <td><%= day_bill(count) %></td>
            </tr>
          <% end %>
        <% end %>

        <% matches.each_with_index do |match, index| %>
          <% index = index + 1 %>
          <tr>
            <td class="center aligned"><%= index %></td>
            <td class="right aligned"><%= match.home_player.team_name %> (<%= match.home_player.name %>)</td>
            <td class="center aligned"><%= match.home_player_score %></td>
            <td class="center aligned">X</td>
            <td class="center aligned"><%= match.visitor_player_score %></td>
            <td><%= match.visitor_player.team_name %> (<%= match.visitor_player.name %>)</td>
            <% if show? %>
              <td class="center aligned"><%= link_to 'Editar', edit_match_path(match), class: 'ui button' %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>

<% end %>
